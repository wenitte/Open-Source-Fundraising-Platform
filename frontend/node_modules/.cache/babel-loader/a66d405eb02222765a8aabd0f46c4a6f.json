{"ast":null,"code":"import _classCallCheck from\"/Users/josiasapiou/dev/raiseme/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/josiasapiou/dev/raiseme/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/josiasapiou/dev/raiseme/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/josiasapiou/dev/raiseme/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/josiasapiou/dev/raiseme/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import _taggedTemplateLiteral from\"/Users/josiasapiou/dev/raiseme/frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral\";var _templateObject,_templateObject2,_templateObject3;import React,{Component}from'react';import styled from'styled-components';import axios from'axios';import StripeCheckout from'react-stripe-checkout';import getSymbolFromCurrency from'currency-symbol-map';import CONFIGURATION from'../configuration';import{database}from'../utils/firebase';import Button from'./Button';import Input from'./Input';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var fromTalerToCent=function fromTalerToCent(amount){return amount*100;};var onToken=function onToken(amount,description,onSuccess,onError){return function(token){return axios.post(process.env.PAYMENT_SERVER_URL,{description:description,source:token.id,currency:CONFIGURATION.currency,amount:fromTalerToCent(amount)}).then(onSuccess).catch(onError);};};var Form=styled.div(_templateObject||(_templateObject=_taggedTemplateLiteral([\"\\n  display: flex;\\n  flex-direction: column;\\n  align-items: center;\\n\"])));var FormContent=styled.div(_templateObject2||(_templateObject2=_taggedTemplateLiteral([\"\\n  margin: 5px;\\n\"])));var Label=styled.label(_templateObject3||(_templateObject3=_taggedTemplateLiteral([\"\\n  margin-right: 10px;\\n\"])));var Checkout=/*#__PURE__*/function(_Component){_inherits(Checkout,_Component);var _super=_createSuper(Checkout);function Checkout(){var _this;_classCallCheck(this,Checkout);_this=_super.call(this);_this.state={amount:CONFIGURATION.defaultAmount,username:'',isSuccess:null,isError:null};_this.onAmountChange=_this.onAmountChange.bind(_assertThisInitialized(_this));_this.onUsernameChange=_this.onUsernameChange.bind(_assertThisInitialized(_this));_this.onSuccess=_this.onSuccess.bind(_assertThisInitialized(_this));_this.onError=_this.onError.bind(_assertThisInitialized(_this));return _this;}_createClass(Checkout,[{key:\"onUsernameChange\",value:function onUsernameChange(event){var value=event.target.value;this.setState({username:value});}},{key:\"onAmountChange\",value:function onAmountChange(event){var value=event.target.value;this.setState({amount:value<0?value*-1:value});}},{key:\"onSuccess\",value:function onSuccess(_ref){var data=_ref.data;var _this$state=this.state,amount=_this$state.amount,username=_this$state.username;database.ref('fundings').push({amount:+amount,email:data.success.source.name,username:username,currency:CONFIGURATION.currency});this.setState({isSuccess:true});}},{key:\"onError\",value:function onError(){this.setState({isError:true});}},{key:\"render\",value:function render(){var _this$state2=this.state,amount=_this$state2.amount,username=_this$state2.username,isError=_this$state2.isError,isSuccess=_this$state2.isSuccess;if(isSuccess){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"p\",{children:\"Thanks for your funding!\"})});}if(isError){return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(\"p\",{children:\"Something went wrong. The payment couldn't be processed.\"})});}return/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(Form,{children:[/*#__PURE__*/_jsxs(FormContent,{children:[/*#__PURE__*/_jsxs(Label,{children:[\"Amount (\",getSymbolFromCurrency(CONFIGURATION.currency),\"):\"]}),/*#__PURE__*/_jsx(Input,{type:\"number\",min:\"1\",max:\"99999\",value:amount,onChange:this.onAmountChange,required:true})]}),/*#__PURE__*/_jsxs(FormContent,{children:[/*#__PURE__*/_jsx(Label,{children:\"Your Name (leave empty to stay anonymous):\"}),/*#__PURE__*/_jsx(Input,{type:\"text\",onChange:this.onUsernameChange,value:username})]}),/*#__PURE__*/_jsx(FormContent,{children:/*#__PURE__*/_jsx(StripeCheckout,{name:CONFIGURATION.checkoutTitle,description:CONFIGURATION.checkoutDescription,amount:fromTalerToCent(amount),token:onToken(amount,CONFIGURATION.checkoutDescription,this.onSuccess,this.onError),currency:CONFIGURATION.currency,stripeKey:\"pk_live_51HV2hVBmviTa8H94aBVwgoblrOufLON91PvlctBzcNk3paJcPTAf0KWHkTbLU4xieIy68vRJUzvWlwQTzreaZnQK00RbTNTkll\",panelLabel:CONFIGURATION.checkoutButtonLabel,children:/*#__PURE__*/_jsx(Button,{type:\"button\",children:CONFIGURATION.callToAction})})})]})});}}]);return Checkout;}(Component);export default Checkout;","map":{"version":3,"sources":["/Users/josiasapiou/dev/raiseme/frontend/src/components/Checkout.js"],"names":["React","Component","styled","axios","StripeCheckout","getSymbolFromCurrency","CONFIGURATION","database","Button","Input","fromTalerToCent","amount","onToken","description","onSuccess","onError","token","post","process","env","PAYMENT_SERVER_URL","source","id","currency","then","catch","Form","div","FormContent","Label","label","Checkout","state","defaultAmount","username","isSuccess","isError","onAmountChange","bind","onUsernameChange","event","value","target","setState","data","ref","push","email","success","name","checkoutTitle","checkoutDescription","checkoutButtonLabel","callToAction"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport styled from 'styled-components';\nimport axios from 'axios';\nimport StripeCheckout from 'react-stripe-checkout';\nimport getSymbolFromCurrency from 'currency-symbol-map';\n\nimport CONFIGURATION from '../configuration';\nimport { database } from '../utils/firebase';\n\nimport Button from './Button';\nimport Input from './Input';\n\nconst fromTalerToCent = amount => amount * 100;\n\nconst onToken = (amount, description, onSuccess, onError) => token =>\n  axios\n    .post(process.env.PAYMENT_SERVER_URL, {\n      description,\n      source: token.id,\n      currency: CONFIGURATION.currency,\n      amount: fromTalerToCent(amount),\n    })\n    .then(onSuccess)\n    .catch(onError);\n\nconst Form = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n`;\n\nconst FormContent = styled.div`\n  margin: 5px;\n`;\n\nconst Label = styled.label`\n  margin-right: 10px;\n`;\n\nclass Checkout extends Component {\n  constructor() {\n    super();\n\n    this.state = {\n      amount: CONFIGURATION.defaultAmount,\n      username: '',\n      isSuccess: null,\n      isError: null\n    };\n\n    this.onAmountChange = this.onAmountChange.bind(this);\n    this.onUsernameChange = this.onUsernameChange.bind(this);\n    this.onSuccess = this.onSuccess.bind(this);\n    this.onError = this.onError.bind(this);\n  }\n\n  onUsernameChange(event) {\n    const { value } = event.target;\n    this.setState({ username: value });\n  }\n\n  onAmountChange(event) {\n    const { value } = event.target;\n    this.setState({ amount: value < 0 ? value * -1 : value });\n  }\n\n  onSuccess({ data }) {\n    const { amount, username } = this.state;\n\n    database.ref('fundings').push({\n      amount: +amount,\n      email: data.success.source.name,\n      username,\n      currency: CONFIGURATION.currency\n    });\n\n    this.setState({ isSuccess: true });\n  }\n\n  onError() {\n    this.setState({ isError: true });\n  }\n\n  render() {\n    const {\n      amount,\n      username,\n      isError,\n      isSuccess,\n    } = this.state;\n\n    if (isSuccess) {\n      return (\n        <div>\n          <p>Thanks for your funding!</p>\n        </div>\n      );\n    }\n\n    if (isError) {\n      return (\n        <div>\n          <p>Something went wrong. The payment couldn't be processed.</p>\n        </div>\n      );\n    }\n\n    return (\n      <div>\n        <Form>\n          <FormContent>\n            <Label>\n              Amount ({getSymbolFromCurrency(CONFIGURATION.currency)}):\n            </Label>\n\n            <Input\n              type=\"number\"\n              min=\"1\"\n              max=\"99999\"\n              value={amount}\n              onChange={this.onAmountChange}\n              required\n            />\n          </FormContent>\n\n          <FormContent>\n            <Label>Your Name (leave empty to stay anonymous):</Label>\n\n            <Input\n              type=\"text\"\n              onChange={this.onUsernameChange}\n              value={username}\n            />\n          </FormContent>\n\n          <FormContent>\n            <StripeCheckout\n              name={CONFIGURATION.checkoutTitle}\n              description={CONFIGURATION.checkoutDescription}\n              amount={fromTalerToCent(amount)}\n              token={onToken(\n                amount,\n                CONFIGURATION.checkoutDescription,\n                this.onSuccess,\n                this.onError\n              )}\n              currency={CONFIGURATION.currency}\n              stripeKey={\"pk_live_51HV2hVBmviTa8H94aBVwgoblrOufLON91PvlctBzcNk3paJcPTAf0KWHkTbLU4xieIy68vRJUzvWlwQTzreaZnQK00RbTNTkll\"}\n              panelLabel={CONFIGURATION.checkoutButtonLabel}\n            >\n              <Button type=\"button\">{CONFIGURATION.callToAction}</Button>\n            </StripeCheckout>\n          </FormContent>\n        </Form>\n      </div>\n    );\n  }\n}\n\nexport default Checkout;\n"]},"metadata":{},"sourceType":"module"}